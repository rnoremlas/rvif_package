<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Decision Rule to Detect Troubling Multicollinearity — multicollinearity • rvif</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Decision Rule to Detect Troubling Multicollinearity — multicollinearity"><meta name="description" content="Given a multiple linear regression model with n observations and k independent variables,
the degree of near-multicollinearity affects its statistical analysis (with a level of significance
of alpha%) if there is a variable i, with i = 1,...,k, that verifies that the null hypothesis is not
rejected in the original model and is rejected in the orthogonal model of reference."><meta property="og:description" content="Given a multiple linear regression model with n observations and k independent variables,
the degree of near-multicollinearity affects its statistical analysis (with a level of significance
of alpha%) if there is a variable i, with i = 1,...,k, that verifies that the null hypothesis is not
rejected in the original model and is rejected in the orthogonal model of reference."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rvif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/The_rvif_package.html">The_rvif_package</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rnoremlas/rvif_package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Decision Rule to Detect Troubling Multicollinearity</h1>

      <div class="d-none name"><code>multicollinearity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a multiple linear regression model with n observations and k independent variables,
the degree of near-multicollinearity affects its statistical analysis (with a level of significance
of alpha%) if there is a variable i, with i = 1,...,k, that verifies that the null hypothesis is not
rejected in the original model and is rejected in the orthogonal model of reference.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numerical vector representing the dependent variable of the model.</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numerical design matrix that should contain more than one regressor (intercept included in the first column).</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level (by default, 5%).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function compares the individual inference of the original model with that of the orthonormal model taken as reference.</p>
<p>Thus, if the null hypothesis is rejected in the individual significance tests in the model where there are no linear
relationships between the independent variables (orthonormal) and is not rejected in the original model, the reason
for the non-rejection is due to the existing linear relationships between the independent variables (multicollinearity)
in the original model.</p>
<p>The second model is obtained from the first model by performing a QR decomposition, which eliminates the initial
linear relationships.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns the value of the RVIF and the established thresholds, as well as indicating whether or not the individual
significance analysis is affected by multicollinearity at the chosen significance level.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Salmerón, R., García, C.B. and García, J. (2025). A Redefined Variance Inflation Factor: overcoming the limitations of
the Variance Inflation Factor. Computational Economics, 65, 337-363, doi: <a href="https://doi.org/10.1007/s10614-024-10575-8" class="external-link">doi:10.1007/s10614-024-10575-8</a>
.</p>
<p>Overcoming the inconsistences of the variance inflation factor: a redefined VIF and a test to detect statistical
troubling multicollinearity by Salmerón, R., García, C.B and García, J. (working paper, <a href="https://arxiv.org/pdf/2005.02245" class="external-link">https://arxiv.org/pdf/2005.02245</a>).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Román Salmerón Gómez (University of Granada) and Catalina B. García García (University of Granada).</p>
<p>Maintainer: Román Salmerón Gómez (romansg@ugr.es)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="rvifs.html">rvifs</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### Example 1</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">obs</span> <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>  <span class="va">cte</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">obs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">5</span>, <span class="fl">0.01</span><span class="op">)</span>  <span class="co"># related to intercept: non essential</span></span></span>
<span class="r-in"><span>  <span class="va">x3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x4</span> <span class="op">=</span> <span class="va">x3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">5</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="co"># related to x3: essential</span></span></span>
<span class="r-in"><span>  <span class="va">x5</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x6</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">15</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="fl">4</span> <span class="op">+</span> <span class="fl">5</span><span class="op">*</span><span class="va">x2</span> <span class="op">-</span> <span class="fl">9</span><span class="op">*</span><span class="va">x3</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">x4</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">x5</span> <span class="op">+</span> <span class="fl">7</span><span class="op">*</span><span class="va">x6</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cte</span>, <span class="va">x2</span>, <span class="va">x3</span>, <span class="va">x4</span>, <span class="va">x5</span>, <span class="va">x6</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          RVIFs          c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.522626e+03 710.3979874 1.502436e-01      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 9.875420e+01  41.8217535 3.659512e-01      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 5.555945e-02   4.5808651 7.263924e-07      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 5.528041e-02   0.3113603 1.122944e-02      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.234970e-03   0.2585459 6.317865e-06      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 5.039751e-02   3.3626976 7.553190e-04      a.1      No</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 2</span></span></span>
<span class="r-in"><span><span class="co">### Effect of sample size</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">obs</span> <span class="op">=</span> <span class="fl">25</span> <span class="co"># by decreasing the number of observations affected to x4 </span></span></span>
<span class="r-in"><span>  <span class="va">cte</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">obs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">5</span>, <span class="fl">0.01</span><span class="op">)</span>  <span class="co"># related to intercept: non essential</span></span></span>
<span class="r-in"><span>  <span class="va">x3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x4</span> <span class="op">=</span> <span class="va">x3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">5</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="co"># related to x3: essential</span></span></span>
<span class="r-in"><span>  <span class="va">x5</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x6</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">15</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="fl">4</span> <span class="op">+</span> <span class="fl">5</span><span class="op">*</span><span class="va">x2</span> <span class="op">-</span> <span class="fl">9</span><span class="op">*</span><span class="va">x3</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">x4</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">x5</span> <span class="op">+</span> <span class="fl">7</span><span class="op">*</span><span class="va">x6</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cte</span>, <span class="va">x2</span>, <span class="va">x3</span>, <span class="va">x4</span>, <span class="va">x5</span>, <span class="va">x6</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          RVIFs           c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.286600e+04 1.053297e+04 9.384591e-01      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 5.707087e+02 5.156288e+02 1.726140e+02      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 4.045355e-01 6.263143e+00 2.210555e-05      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 4.005247e-01 4.780367e-02 9.441789e-02      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 4.651546e-03 2.659262e-01 7.675577e-05      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 4.833250e-01 1.945277e+00 1.200872e-01      a.1      No</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 3</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="fl">4</span> <span class="op">-</span> <span class="fl">9</span><span class="op">*</span><span class="va">x3</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">x5</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cte</span>, <span class="va">x3</span>, <span class="va">x5</span><span class="op">)</span> <span class="co"># independently generated</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          RVIFs        c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.0446929027 0.7442711 1.003540e-04      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.0004039021 4.2977544 3.601141e-08      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.0044674952 0.2131438 9.363871e-05      a.1      No</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">### Example 4</span></span></span>
<span class="r-in"><span><span class="co">### Detection of multicollinearity in Wissel data</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Wissel</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      t      D cte      C      I     CP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1996 3.8051   1 4.7703 4.8786 808.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1997 3.9458   1 4.7784 5.0510 798.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1998 4.0579   1 4.9348 5.3620 806.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1999 4.1913   1 5.0998 5.5585 865.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2000 4.3585   1 5.2907 5.8425 997.30</span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="va">Wissel</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="va">Wissel</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          RVIFs           c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.948661e+02 7.371069e+00 1.017198e+00      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.032628e+01 4.456018e+00 9.157898e-01      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 4.765888e+00 2.399341e+00 1.053598e+01      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 3.821626e-05 2.042640e-06 7.149977e-04      b.2      No</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">### Example 5</span></span></span>
<span class="r-in"><span><span class="co">### Detection of multicollinearity in euribor data</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">euribor</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      E cte  HIPC    BC       GD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.63   1 92.92 17211 -51384.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.90   1 93.85  2724 -49567.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 3.45   1 93.93 17232 -52128.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 3.01   1 94.41  9577 -53593.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2.54   1 95.08  4117 -65480.0</span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="va">euribor</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="va">euribor</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          RVIFs           c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 5.325408e+00 1.575871e+01 2.166907e-02      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 5.357830e-04 3.219456e-06 4.249359e-05      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 5.109564e-11 1.098649e-09 2.586237e-12      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1.631439e-11 3.216522e-10 8.274760e-13      a.1      No</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">### Example 6</span></span></span>
<span class="r-in"><span><span class="co">### Detection of multicollinearity in Cobb-Douglas production function data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">CDpf</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          P cte     logK     logW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 37641114   1 17.93734 15.55598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 42620804   1 18.01187 15.60544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 37989413   1 17.98800 15.54486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 40464915   1 18.00700 15.58605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 41002031   1 18.02283 15.59570</span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="va">CDpf</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="va">CDpf</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>  </span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         RVIFs           c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 6388.881402 88495.933700   1.64951764      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    4.136993   207.628058   0.05043083      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   37.336325     9.445619 147.58213164      b.2      No</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">### Example 7</span></span></span>
<span class="r-in"><span><span class="co">### Detection of multicollinearity in number of employees of Spanish companies data</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">employees</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NE cte       FA       OI        S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   2637   1    44153    38903    38867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  15954   1  9389509  4293386  4231043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 162503   1 17374000 23703000 23649000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 162450   1  9723088 23310532 23310532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  28389   1 95980120 29827663 29215382</span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="va">employees</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="va">employees</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          RVIFs           c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.829154e-16 2.307712e-16 4.679301e-17      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.696454e-12 9.594942e-13 2.129511e-13      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.718535e-12 1.100437e-12 2.683809e-12      b.2      No</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">### Example 8</span></span></span>
<span class="r-in"><span><span class="co">### Detection of multicollinearity in simple linear model simulated data</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SLM1</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1 cte         V</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  82.392059   1 19.001420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  -1.942157   1 -1.733458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   7.474090   1  1.025146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -12.303381   1 -4.445014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  30.378203   1  6.689864</span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="va">SLM1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="va">SLM1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          RVIFs        c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.0403049717 0.6454323 1.045802e-05      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.0002675731 0.8383436 8.540101e-08      a.1      No</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SLM2</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         y2 cte         Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 43.01204   1  9.978211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 40.04163   1  9.878235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 40.17086   1  9.924592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 40.79076   1 10.019123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 44.72774   1 10.104728</span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="va">SLM2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="va">SLM2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        RVIFs         c0         c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 187.800878 21.4798003 0.03277691      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1.879296  0.3687652 9.57724567      b.2      No</span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span><span class="co">### Example 9</span></span></span>
<span class="r-in"><span><span class="co">### Detection of multicollinearity in soil characteristics data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">soil</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   BaseSat SumCation CECbuffer     Ca     Mg      K    Na     P    Cu    Zn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    2.34    0.1576     0.614 0.0892 0.0328 0.0256 0.010 0.000 0.080 0.184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1.64    0.0970     0.516 0.0454 0.0218 0.0198 0.010 0.000 0.064 0.112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    5.20    0.4520     0.828 0.3306 0.0758 0.0336 0.012 0.240 0.136 0.350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    4.10    0.3054     0.698 0.2118 0.0536 0.0260 0.014 0.030 0.126 0.364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    2.70    0.2476     0.858 0.1568 0.0444 0.0304 0.016 0.384 0.078 0.376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Mn HumicMatter Density    pH ExchAc Diversity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.200      0.1220  0.0822 0.516  0.466 0.2765957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2.734      0.0952  0.0850 0.512  0.430 0.2613982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 4.148      0.1822  0.0746 0.554  0.388 0.2553191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 3.728      0.1646  0.0756 0.546  0.408 0.2401216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 4.756      0.2472  0.0692 0.450  0.624 0.1884498</span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="va">soil</span><span class="op">[</span>,<span class="fl">16</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="va">soil</span><span class="op">[</span>,<span class="op">-</span><span class="fl">16</span><span class="op">]</span> </span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="va">x</span><span class="op">)</span> <span class="co"># the design matrix has to have the intercept in the first column</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> System is computationally singular. Modify the design matrix before running the code.</span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="co"># eliminating the problematic variable (SumCation)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           RVIFs           c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  4.407184e+02 6.150190e-03 1.480048e+00      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  3.828858e+00 1.142356e-02 7.653413e+00      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1.093791e+05 1.254955e+02 7.236491e+04      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  9.883235e+04 3.938383e+01 2.237445e+05      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1.767758e+05 1.101028e+03 3.609837e+05      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1.150029e+05 1.627349e+03 1.976176e+05      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  4.627807e+04 5.960870e+02 2.033176e+06      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1.338591e+01 6.062571e-01 4.060382e+02      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  3.113066e+02 4.089095e+01 5.246698e+05      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 5.177176e+01 6.371216e+00 8.094828e+02      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 1.905089e-01 3.907589e-02 9.787963e-01      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 3.379360e+02 4.534540e+01 2.861964e+02      b.1     Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 4.761238e+04 8.453066e+01 3.828016e+08      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 1.502903e+03 7.901580e+01 9.961215e+03      b.2      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 1.066711e+05 2.369347e+02 4.802466e+07      b.2      No</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">### Example 10</span></span></span>
<span class="r-in"><span><span class="co">### The intercept must be in the first column of the design matrix</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">obs</span> <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>  <span class="va">cte</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">obs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="va">obs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="va">obs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="va">obs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cte</span>, <span class="va">x2</span>, <span class="va">x3</span>, <span class="va">x4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">u</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">=</span> <span class="fl">5</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">x2</span> <span class="op">-</span> <span class="fl">3</span><span class="op">*</span><span class="va">x3</span> <span class="op">+</span> <span class="fl">10</span><span class="op">*</span><span class="va">x4</span> <span class="op">+</span> <span class="va">u</span></span></span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> There is a constant variable. Delete it before running the code or, if it is the intercept, it must be the first column of the design matrix.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Perfect multicollinearity exists. Modify the design matrix before running the code.</span>
<span class="r-in"><span>  <span class="fu">multicollinearity</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">[</span>,<span class="op">-</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="co"># the constant variable is removed</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          RVIFs          c0           c3 Scenario Affects</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 7.404884e-02 121.0498871 4.062417e-07      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 4.750899e-07   0.2408853 9.995920e-13      a.1      No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 4.977510e-07   0.5417202 4.573507e-13      a.1      No</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by R. Salmerón, C.B. García.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

